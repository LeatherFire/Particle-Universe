<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Particle Universe - 3D GPU Particle System</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âœ¨</text></svg>">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="/assets/vendor/litegraph/litegraph.css">
</head>
<body>
  <!-- WebGPU not supported warning -->
  <div id="webgpu-warning" style="display:none;">
    <h2>WebGPU Not Supported</h2>
    <p>This application requires WebGPU. Please use Chrome 113+, Edge 113+, or Safari 18+.</p>
  </div>

  <!-- Compatibility mode banner -->
  <div id="compatibility-banner"></div>
  <div id="runtime-notice" aria-live="polite"></div>

  <!-- 3D Viewport -->
  <canvas id="viewport"></canvas>
  <section id="shader-builder-workspace" class="hidden"></section>

  <!-- Loading screen -->
  <div id="loading">
    <div class="loading-spinner"></div>
    <p>Initializing GPU Particle Engine...</p>
  </div>

  <!-- Top bar -->
  <header id="top-bar">
    <div class="top-bar-left">
      <h1 class="logo">Particle<span class="logo-accent">Universe</span></h1>
    </div>
    <div id="preset-tabs" class="preset-tabs">
      <button class="preset-tab active" data-category="core">Core</button>
      <button class="preset-tab" data-category="vfxLab">VFX Lab</button>
      <button class="preset-tab" data-category="modelFx">Model FX</button>
      <button class="preset-tab" data-category="shaderBuilder">Shader Builder</button>
    </div>
    <div id="preset-container" class="preset-scroll">
      <!-- Preset buttons will be dynamically generated -->
    </div>
  </header>

  <!-- Right sidebar control panel -->
  <aside id="control-panel">
    <div id="gui-container"></div>
    <div id="custom-widgets">
      <div class="widget-section">
        <h3 class="widget-label">Color Over Lifetime</h3>
        <div id="gradient-editor-container"></div>
      </div>
      <div class="widget-section">
        <h3 class="widget-label">Size Over Lifetime</h3>
        <div id="size-curve-container"></div>
      </div>
      <div class="widget-section">
        <h3 class="widget-label">Opacity Over Lifetime</h3>
        <div id="opacity-curve-container"></div>
      </div>
      <div class="widget-section">
        <div id="model-fx-panel-container"></div>
      </div>
    </div>
  </aside>

  <!-- Toggle sidebar button -->
  <button id="toggle-panel" title="Toggle Panel">
    <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
      <rect x="2" y="3" width="16" height="2" rx="1"/>
      <rect x="2" y="9" width="16" height="2" rx="1"/>
      <rect x="2" y="15" width="16" height="2" rx="1"/>
    </svg>
  </button>

  <!-- Bottom status bar -->
  <footer id="status-bar">
    <div class="status-left">
      <span class="status-item" id="fps-display">
        <span class="status-label">FPS</span>
        <span class="status-value" id="fps-value">60</span>
      </span>
      <span class="status-divider"></span>
      <span class="status-item" id="particle-display">
        <span class="status-label">Particles</span>
        <span class="status-value" id="particle-value">200,000</span>
      </span>
      <span class="status-divider"></span>
      <span class="status-item" id="gpu-display">
        <span class="status-label">Backend</span>
        <span class="status-value" id="gpu-value">WebGPU</span>
      </span>
    </div>
    <div class="status-right">
      <button class="action-btn" id="btn-screenshot" title="Screenshot (S)">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="12" cy="12" r="3"/></svg>
      </button>
      <button class="action-btn" id="btn-record" title="Record (R)">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="9"/><circle cx="12" cy="12" r="4" fill="currentColor"/></svg>
      </button>
      <button class="action-btn" id="btn-grid" title="Toggle Grid (G)">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="3" x2="3" y2="21"/><line x1="9" y1="3" x2="9" y2="21"/><line x1="15" y1="3" x2="15" y2="21"/><line x1="21" y1="3" x2="21" y2="21"/><line x1="3" y1="3" x2="21" y2="3"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="3" y1="15" x2="21" y2="15"/><line x1="3" y1="21" x2="21" y2="21"/></svg>
      </button>
      <button class="action-btn" id="btn-fullscreen" title="Fullscreen (F)">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" y1="3" x2="14" y2="10"/><line x1="3" y1="21" x2="10" y2="14"/></svg>
      </button>
    </div>
  </footer>

  <script type="importmap">
	  {
	    "imports": {
	      "three": "https://cdn.jsdelivr.net/npm/three@0.171.0/build/three.webgpu.js",
	      "three/webgl": "https://cdn.jsdelivr.net/npm/three@0.171.0/build/three.module.js",
	      "three/webgpu": "https://cdn.jsdelivr.net/npm/three@0.171.0/build/three.webgpu.js",
	      "three/tsl": "https://cdn.jsdelivr.net/npm/three@0.171.0/build/three.tsl.js",
	      "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.171.0/examples/jsm/",
	      "lil-gui": "https://cdn.jsdelivr.net/npm/lil-gui@0.20.0/dist/lil-gui.esm.min.js"
    }
  }
  </script>

  <script src="/assets/vendor/litegraph/litegraph.min.js"></script>
  <script type="module" src="js/main.js"></script>
</body>
</html>
